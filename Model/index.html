<!DOCTYPE html>

<html>

    <head>
        
    

    <title>
        Model
    </title>

    
    <link rel="icon" href="../assets/favicon.svg" sizes="any" type="image/svg+xml">
    <link href='https://fonts.googleapis.comcss?family=Source+Sans+Pro:400,300,600,400italic,700' rel='stylesheet' type='textcss'>

    
    <link rel="stylesheet" type="text/css" href="../css/reseter.min.css">
    <link rel="stylesheet" type="text/css" href="../css/simple-line-icons.min.css">
    <link rel="stylesheet" type="text/css" href="../css/fontawesome.min.css">
    <link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../css/animate.min.css">
    <link rel="stylesheet" type="text/css" href="../css/igem-reset.css">

    
    
    
    
    <link rel="stylesheet" type="text/css" href="../css/styles.css">


    


    

    
    <script type="text/javascript" src="../js/jquery.min.js" defer></script>

    
	<script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>

    
    <script type="text/javascript" src="../js/jquery.sticky.min.js" defer></script>
	<script type="text/javascript" src="../js/popper.min.js" defer></script>
	<script type="text/javascript" src="../js/bootstrap.min.js" defer></script>
	<script type="text/javascript" src="../js/respond.min.js" defer></script>
	<script type="text/javascript" src="../js/asb.js" defer></script>
	<script type="text/javascript" src="../js/parallax.min.js" defer></script>
    <script type="text/javascript" src="../js/mathjax.min.js" defer></script>
    <script type="text/javascript" src="../js/main.js" defer></script>


    

    </head>
    <body>
        
</p>
</div>
</div>
</div>
</div>
</div>

        <div id="loader-wrapper">
    <div id="loader">
        
        <div class="starts-wrapper">
            <div class='stars-small'></div>
            <div class='stars-big'></div>
        </div>

        
        <div class="moon-wrapper">
            <div class="moon">
                <div class="disc"></div>
            </div>
        </div>

        
        <p id="loadingMessage" style="display: none;"></p>
        <script>
            var messages = [
                "Generating witty dialog...",
                "We need a new fuse...",
                "...and enjoy the elevator music...",
                "Go ahead -- hold your breath!",
                "...at least you're not on hold...",
                "Why don't you order a sandwich?",
                "It's still faster than you could draw it",
                "My other loading screen is much faster.",
                "Reconfoobling energymotron...",
                "Are we there yet?",
                "Just count to 10",
                "Don't panic...",
                "Do not run! We are your friends!",
                "Warning: Don't set yourself on fire.",
                "Creating time-loop inversion field",
                "Spinning the wheel of fortune...",
                "I'm sorry Dave, I can't do that.",
                "I feel like im supposed to be loading something...",
                "Adjusting flux capacitor...",
                "I swear it's almost done.",
                "Let's take a mindfulness minute...",
                "Cleaning off the cobwebs...",
                "Making sure all the i's have dots...",
                "Granting wishes...",
                "Time flies when you’re having fun.",
                "Get some coffee and come back in ten minutes...",
                "You shall not pass! yet...",
                "Your left thumb points to the right and your right thumb points to the left.",
                "How did you get here?",
                "Wait, do you smell something burning?",
                "Computing the secret to life, the universe, and everything.",
                "Hello IT, have you tried turning it off and on again?",
                "What is the airspeed velocity of an unladen swallow?",
                "Hello, IT... Have you tried forcing an unexpected reboot?",
                "Didn't know paint dried so quickly.",
                "Twiddling thumbs...",
                "Sending data to NS-i mean, our servers.",
                "Looking for sense of humour, please hold on.",
                "A different error message? Finally, some progress!",
                "Distracted by cat gifs",
                "@todo Insert witty loading message",
                "Let's hope it's worth the wait",
                "Whatever you do, don't look behind you...",
                "Please wait... Consulting the manual...",
                "Loading funny message...",
                "Feel free to spin in your chair",
                "Help, I'm trapped in a loader!",
                "Never let a computer know you're in a hurry.",
                "How about this weather, eh?",
                "Reading Terms and Conditions for you.",
                "Discovering new ways of making you wait...",
                "Your time is very important to us. Please wait while we ignore you...",
                "Time flies like an arrow; fruit flies like a banana",
                "Two men walked into a bar; the third ducked...",
                "TODO: Insert elevator music",
                "We're working very Hard .... Really",
                "You are number 2843684714 in the queue"
            ];
            
            var message = messages[Math.floor(Math.random() * messages.length)];
            document.getElementById("loadingMessage").innerHTML = message;
            document.getElementById("loadingMessage").style = "display: block;"
        </script>
    </div>
</div>


        
<div class="site-mobile-menu site-navbar-target">
    <div class="site-mobile-menu-header">
        <div class="site-mobile-menu-close mt-3">
            <span class="fa fa-times js-menu-toggle"></span>
        </div>
    </div>
    <div class="site-mobile-menu-body"></div>
</div>


<header class="site-navbar js-sticky-header site-navbar-target" role="banner">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-6 col-xl-2">
                
                <h1 class="mb-0 site-logo"><a href="../">
                    

                    
                        <img src="../assets/images/logo.png" alt="Brand logo">
                    
                </a></h1>
            </div>

            
            <div id="navbar-main-wrapper" class="col-12 col-md-10 d-none d-xl-block">
                <nav class="site-navigation position-relative text-right" role="navigation">

                    <ul class="site-menu main-menu js-clone-nav mr-auto d-none d-lg-block">
                        
                            
                                
                                <li class="has-children">
                                    <a href="#" class="nav-link">Project&nbsp;&nbsp;</a>
                                    <ul class="dropdown">
                                        
                                            <li><a href="../Description" class="nav-link">Description</a></li>
                                        
                                            <li><a href="../Planning" class="nav-link">Planning</a></li>
                                        
                                            <li><a href="../Engineering" class="nav-link">Engineering</a></li>
                                        
                                            <li><a href="../Model" class="nav-link">Model</a></li>
                                        
                                            <li><a href="../Implementation" class="nav-link">Implementation</a></li>
                                        
                                    </ul>
                                </li>
                            
                        
                            
                                
                                <li class="has-children">
                                    <a href="#" class="nav-link">Lab work&nbsp;&nbsp;</a>
                                    <ul class="dropdown">
                                        
                                            <li><a href="../Experiments" class="nav-link">Experiments</a></li>
                                        
                                    </ul>
                                </li>
                            
                        
                            
                                
                                <li class="has-children">
                                    <a href="#" class="nav-link">Human practices&nbsp;&nbsp;</a>
                                    <ul class="dropdown">
                                        
                                            <li><a href="../Human_Practices" class="nav-link">Human practices</a></li>
                                        
                                            <li><a href="../Communication" class="nav-link">Communication</a></li>
                                        
                                    </ul>
                                </li>
                            
                        
                            
                                
                                <li class="has-children">
                                    <a href="#" class="nav-link">Team&nbsp;&nbsp;</a>
                                    <ul class="dropdown">
                                        
                                            <li><a href="../Team" class="nav-link">Meet the team</a></li>
                                        
                                            <li><a href="../Attributions" class="nav-link">Attributions</a></li>
                                        
                                            <li><a href="../Contribution" class="nav-link">Contributions</a></li>
                                        
                                            <li><a href="../Collaborations" class="nav-link">Collaborations</a></li>
                                        
                                            <li><a href="../Sponsors" class="nav-link">Sponsors</a></li>
                                        
                                    </ul>
                                </li>
                            
                        
                            
                                
                                <li class="has-children">
                                    <a href="#" class="nav-link">Judging&nbsp;&nbsp;</a>
                                    <ul class="dropdown">
                                        
                                            <li><a href="../Awards" class="nav-link">Awards</a></li>
                                        
                                            <li><a href="../Medal_Critera" class="nav-link">Medal Criteria</a></li>
                                        
                                    </ul>
                                </li>
                            
                        
                    </ul>
                </nav>
            </div>

            
            <div class="col-6 d-inline-block d-xl-none ml-md-0 py-3" style="position: relative; top: 3px">
                <a href="#" class="site-menu-toggle js-menu-toggle float-right">
                    <span class="fas fa-bars"></span>
                </a>
            </div>
        </div>
    </div>
</header>

        <div class="content-wrapper">
            


    <section id="hero" data-parallax="scroll" data-speed="0.4"
        data-image-src="../assets/content/model/splash_back.png">
        <div id="hero_fore" style="background-image: url('/assets/content/model/splash_fore.png');"></div>
    </section>


            
<section id="hugo-content-wrapper">


    
    
    
    
    
        <script src="../js/sidebarScrollPath.js" defer></script>
        
        <div class="row">
            
            <section id="sidebar" class="col-3"> 
                <div class="toc-wrapper content-page">
                    
                        <h3><a href="#">Model</a></h3>
                    
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#custom-modelling">Custom modelling</a>
      <ul>
        <li><a href="#abstract">Abstract</a></li>
        <li><a href="#summary-of-results">Summary of results</a></li>
        <li><a href="#interactive-web-model">Interactive web model</a></li>
        <li><a href="#implementation">Implementation</a></li>
        <li><a href="#software-engineering">Software engineering</a></li>
        <li><a href="#testing-and-validation">Testing and validation</a></li>
        <li><a href="#contextualisation">Contextualisation</a></li>
        <li><a href="#development-and-future-work">Development and future work</a></li>
        <li><a href="#conclusion">Conclusion</a></li>
        <li><a href="#discussion">Discussion</a></li>
      </ul>
    </li>
    <li><a href="#modelling-with-nupack">Modelling with NUPACK</a>
      <ul>
        <li><a href="#references">References</a></li>
      </ul>
    </li>
  </ul>
</nav>
                    <svg class="toc-marker" width="200" height="200" xmlns="http://www.w3.org/2000/svg">
                        <path stroke="#444" stroke-width="3" fill="transparent" stroke-dasharray="0, 0, 0, 1000"
                            stroke-linecap="round" stroke-linejoin="round" transform="translate(-0.5, -0.5)" />
                    </svg>
                </div>
            </section>
            
            <section id="hugo-content" class="col-9">
                
                
                    <div class="content-page">
                        <h2 id="summary">Summary</h2>
                        We used modelling in two ways during the course of our project. The first was a custom computer simulation of how our product may perform in the real world, and the second was using a tool called NUPACK.
                    </div>
                

                
                <div class="content-page">
                    <h2 id="custom-modelling">Custom modelling</h2>
<p>To show that our proposed product would positively benefit the environment where it is proposed to be used, we wrote a custom stochastic computational model of the environment, with and without the product in use, and showed that when it is in use, the model scenario result improved.</p>
<p>We understand that computer models can become quite dry, particularly when explaining the details of their implementation. However, we believe that it is important to do this precisely, even at the cost of conciseness, as a small misunderstanding can be quickly amplified to an unexpected result, since the model&rsquo;s high complexity causes it to have a chaotic output.</p>
<p>As a result of this, we created an in-browser interactive implementation of the model, which plots the output graph of the model based on the user inputting initial parameter states. We intend that this can quickly, intuitively, and interactively show the function and results of the model, which can help inform the goal throughout the implementation explanation, and provide a top-level understanding even if the rest of this page were omitted.</p>
<p>The whole project repository is <a href="https://github.com/Warwick-iGEM-2021/modelling">available on GitHub</a>, and the final production code for the project can be found: <a href="https://raw.githubusercontent.com/Warwick-iGEM-2021/modelling/main/tiered_antibiotic_resistance_model/model.py">as a standalone Python file</a>, or <a href="https://pypi.org/project/tiered-antibiotic-resistance-model/2.0.1/">as a package on PyPI</a></p>
<h3 id="abstract">Abstract</h3>
<p>We propose a validated computational model of the spread of an antibiotic resistant pathogens in a hospital, with and without our diagnostic tool for quickly identifying it, and show that in a relevant scenario it reduces the presence of antibiotic resistant pathogens in our selected scenario, showing our product is beneficial in the real-world.</p>
<h3 id="summary-of-results">Summary of results</h3>
<p>Our results show that our product will be beneficial in the real world. We know this as we validated our model to prove that it is a sufficiently close approximation to reality, then showed that the use of our product improved the model metrics, most notably the total number of deaths and the numbers of Carbapenem resistant bacteria across the run of a model.</p>
<div class="text-center">
    
    
    <img src="../assets/content/model/deaths_violin_plot.png" alt="A violin plot of the total number of deaths over a full run of the model with the validated parameters" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">A violin plot of the total number of deaths over a full run (i.e. till no people are infected) of the model with the validated parameters (discussed in validation section)</p>
    
</div>

<div class="text-center">
    
    
    <img src="../assets/content/model/meropenem_with_without.png" alt="A line plot of the total number of deaths over a full run of the model with the validated parameters" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">A line plot of the total number of deaths over a full run of the model with the validated parameters</p>
    
</div>

<p>It is again evident that the product causes a statistically significant reduction in the number of deaths due to and the number of people infected with a strain of the pathogen resistant to meropenem - the drug resistance detect by our product.</p>
<h3 id="interactive-web-model">Interactive web model</h3>
<p>In order to demonstrate the model without requiring users to download the source code and its dependent libraries, then run it through python, we transpiled it into Javascript, so it can be run in the browser. This interactive transpiled model can be used below to demonstrate how parameters changes can affect the model outcome. Then, in the context section, we identify the parameters for the model which match it to the real world to show our product will work. In practice, having a model with interactive variables isn&rsquo;t especially rigorous, but it does help show the power of the model, and how it can adapt to vastly different scenarios.</p>



<div class="text-center">
    <canvas id="line-chart"></canvas>


    <div class="read_more">
        <div class="read_more_small" style="height: 15em;">
            <button type="button" onclick="run_and_render()">
                <h2>Run the model</h2>
            </button>
            <p id="loading_text" style="display: none;">Model running - this may take a couple of seconds, and possibly
                cause
                the page to hang. It runs locally on your machine, so older computers may struggle with long simulation
                runs or
                high populations</p>
            <p id="error_text" style="display: none; color: red;">An error occurred running the model</p>


            <table id="parameter-inputs">
                <tr>
                    <th>Constants</th>
                    <th>Probabilities</th>
                </tr>
                <tr>
                    <td>
                        <input class="checkboxInput" id="product_in_use_checkbox" type="checkbox">
                        <br><button
                            onclick="model.Params.PRODUCT_IN_USE = document.getElementById('product_in_use_checkbox').checked">
                            Set whether the product is in use</button>
                    </td>
                    <td>
                        <input class="sliderInput" id="probability_product_detect_slider" type="range" min="0" max="1"
                            value="1" step="0.01"
                            oninput="probability_product_detect_text.value=probability_product_detect_slider.value" />
                        <input class="textInput" id="probability_product_detect_text" type="number" value="1" min="0" max="1"
                            step="0.01"
                            oninput="probability_product_detect_slider.value=probability_product_detect_text.value" />
                        <br><button
                            onclick="model.Params.PROBABILIY_PRODUCT_DETECT = parseFloat(document.getElementById('probability_product_detect_text').value)">
                            Set the probability the product works</button>
                    </td>
                </tr>
                <tr>
                    <td>
                        
                        <input class="sliderInput" id="num_timesteps_slider" type="range" min="5" max="200" value="100"
                            oninput="num_timesteps_text.value=num_timesteps_slider.value" />
                        <input class="textInput" id="num_timesteps_text" type="number" value="100" min="5" max="200"
                            oninput="num_timesteps_slider.value=num_timesteps_text.value" />
                        <br><button
                            onclick="model.Params.NUM_TIMESTEPS = parseInt(document.getElementById('num_timesteps_slider').value)">
                            Set the number of timesteps</button>
                    </td>
                    <td>
                        
                        <input class="sliderInput" id="probability_general_recovery_slider" type="range" min="0" max="1"
                            step="0.01" value="0.0"
                            oninput="probability_general_recovery_text.value=probability_general_recovery_slider.value" />
                        <input class="textInput" id="probability_general_recovery_text" type="number" value="0.0" min="0"
                            max="1" step="0.01"
                            oninput="probability_general_recovery_slider.value=probability_general_recovery_text.value" />
                        <br><button
                            onclick="model.Params.PROBABILITY_GENERAL_RECOVERY = parseFloat(document.getElementById('probability_general_recovery_text').value)">
                            Set the probability of general recovery</button>
                    </td>
                </tr>
                <tr>
                    <td>
                        <input class="sliderInput" id="population_size_slider" type="range" min="50" max="10000" step="50"
                            value="500" oninput="population_size_text.value=population_size_slider.value" />
                        <input class="textInput" id="population_size_text" type="number" value="500" min="50" max="10000"
                            oninput="population_size_slider.value=population_size_text.value" />
                        <br><button
                            onclick="model.Params.POPULATION_SIZE = parseInt(document.getElementById('population_size_slider').value)">
                            Set the population size</button>
                    </td>
                    <td>
                        <input class="sliderInput" id="probability_treatment_recovery_slider" type="range" min="0" max="1"
                            value="0.3" step="0.01"
                            oninput="probability_treatment_recovery_text.value=probability_treatment_recovery_slider.value" />
                        <input class="textInput" id="probability_treatment_recovery_text" type="number" value="0.3" min="0"
                            max="1" step="0.01"
                            oninput="probability_treatment_recovery_slider.value=probability_treatment_recovery_text.value" />
                        <br><button
                            onclick="model.Params.PROBABILITY_TREATMENT_RECOVERY = parseFloat(document.getElementById('probability_treatment_recovery_text').value); model.Params.reset_granular_parameters()">
                            Set the probability of treatment recovery</button>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>This option has been removed</p>
                    </td>
                    <td>
                        <input class="sliderInput" id="probability_mutation_slider" type="range" min="0" max="1" value="0.25"
                            step="0.01" oninput="probability_mutation_text.value=probability_mutation_slider.value" />
                        <input class="textInput" id="probability_mutation_text" type="number" value="0.25" min="0" max="1"
                            step="0.01" oninput="probability_mutation_slider.value=probability_mutation_text.value" />
                        <br><button
                            onclick="model.Params.PROBABILITY_MUTATION = parseFloat(document.getElementById('probability_mutation_text').value); model.Params.reset_granular_parameters()">
                            Set the probability of mutation</button>
                    </td>
                </tr>
                <tr>
                    <td>
                        <input class="sliderInput" id="timesteps_move_up_lag_time_slider" type="range" min="0" max="25"
                            value="5" oninput="timesteps_move_up_lag_time_text.value=timesteps_move_up_lag_time_slider.value" />
                        <input class="textInput" id="timesteps_move_up_lag_time_text" type="number" value="5" min="0" max="25"
                            oninput="timesteps_move_up_lag_time_slider.value=timesteps_move_up_lag_time_text.value" />
                        <br><button
                            onclick="model.Params.TIMESTEPS_MOVE_UP_LAG_TIME = parseInt(document.getElementById('timesteps_move_up_lag_time_slider').value)">
                            Set the time lag before increasing treatment</button>
                    </td>
                    <td>
                        <input class="sliderInput" id="probability_move_up_treatment_slider" type="range" min="0" max="1"
                            value="0.2" step="0.01"
                            oninput="probability_move_up_treatment_text.value=probability_move_up_treatment_slider.value" />
                        <input class="textInput" id="probability_move_up_treatment_text" type="number" value="0.2" min="0"
                            max="1" step="0.01"
                            oninput="probability_move_up_treatment_slider.value=probability_move_up_treatment_text.value" />
                        <br><button
                            onclick="model.Params.PROBABILITY_MOVE_UP_TREATMENT = parseFloat(document.getElementById('probability_move_up_treatment_text').value)">
                            Set the probability of moving up treatment</button>
                    </td>
                </tr>
                <tr>
                    <td>
                        <input class="sliderInput" id="isolation_threshold_slider" type="range" min="0" max="5" value="3"
                            oninput="isolation_threshold_text.value=isolation_threshold_slider.value" />
                        <input class="textInput" id="isolation_threshold_text" type="number" value="3" min="0" max="5"
                            oninput="isolation_threshold_slider.value=isolation_threshold_text.value" />
                        <br><button
                            onclick="model.Params.ISOLATION_THRESHOLD = parseInt(document.getElementById('isolation_threshold_slider').value)">
                            Set the resistance level to start isolating</button>
                    </td>
                    <td>
                        <input class="sliderInput" id="probability_death_slider" type="range" min="0" max="1" value="0.015"
                            step="0.01" oninput="probability_death_text.value=probability_death_slider.value" />
                        <input class="textInput" id="probability_death_text" type="number" value="0.015" min="0" max="1"
                            step="0.01" oninput="probability_death_slider.value=probability_death_text.value" />
                        <br><button
                            onclick="model.Params.PROBABILITY_DEATH = parseFloat(document.getElementById('probability_death_text').value); model.Params.reset_granular_parameters()">
                            Set the probability of death</button>
                    </td>
                </tr>
                <tr>
                    <td>
                        <input class="sliderInput" id="num_spread_to_slider" type="range" min="0" max="15" value="1"
                            oninput="num_spread_to_text.value=num_spread_to_slider.value" />
                        <input class="textInput" id="num_spread_to_text" type="number" value="1" min="0" max="15"
                            oninput="num_spread_to_slider.value=num_spread_to_text.value" />
                        <br><button
                            onclick="model.Params.NUM_SPREAD_TO = parseInt(document.getElementById('num_spread_to_slider').value); model.Params.reset_granular_parameters()">
                            Set the number of people spread to</button>
                    </td>
                    <td>
                        <input class="sliderInput" id="probability_spread_slider" type="range" min="0" max="1" value="0.25"
                            step="0.01" oninput="probability_spread_text.value=probability_spread_slider.value" />
                        <input class="textInput" id="probability_spread_text" type="number" value="1" min="0" max="0.25"
                            step="0.01" oninput="probability_spread_slider.value=probability_spread_text.value" />
                        <br><button
                            onclick="model.Params.PROBABILITY_SPREAD = parseFloat(document.getElementById('probability_spread_text').value); model.Params.reset_granular_parameters()">
                            Set the probability of spreading</button>
                    </td>
                </tr>
            </table>
            

        </div>
        <a href="#">Click to show the interactive parameters</a>
    </div>
</div>



<script type="text/javascript" src="../js/chart.min.js"></script>




<script type="text/javascript">
    
    


    
    var url = atob("aHR0cHM6Ly8yMDIxLmlnZW0ub3JnL1RlbXBsYXRlOldhcndpY2svanMvbW9kZWxKUz9hY3Rpb249cmF3JmN0eXBlPXRleHQvamF2YXNjcmlwdA==");
    import(url).then((model) => {
        window.model = model;
    })
</script>








<script>
    
    var ctx = document.getElementById("line-chart");
    
    var options = {
        title: {
            display: true,
            text: 'Spread of an antibiotic infection through a population'
        },
        scales: {
            xAxes: [{
                ticks: {
                    autoSkip: true,
                    maxTicksLimit: 20
                },
                scaleLabel: {
                    display: true,
                    labelString: 'Time / timesteps'
                }
            }],
            yAxes: [{
                scaleLabel: {
                    display: true,
                    labelString: '# people'
                }
            }]
        }
    };

    
    var chart = new Chart(ctx, {
        type: 'line',
        data: [],
        options: options
    });

    async function run_and_render() {
        
        document.getElementById('loading_text').style.display = "block";
        await new Promise(r => setTimeout(r, 100));

        try {
            
            var dataset = window.model.run();
            
            
            chart.destroy()
            chart = new Chart(ctx, {
                type: 'line',
                data: dataset,
                options: options
            });
            
            document.getElementById('error_text').style.display = "none";
        } catch (err) {
            
            document.getElementById('error_text').style.display = "block";
        }

        
        document.getElementById('loading_text').style.display = "none";

    }
</script>

<h3 id="implementation">Implementation</h3>
<p>The key features of the model can be split up into its overall structure, and five distinct sections of its operation, which are enumerated in the sections below.</p>
<p>In each timestep of the model, each of these features are applied to mutate the state of the population. The order in which they are applied, whilst arbitrary, slightly effects the results of the model, in the sense that different application orders would give different results given the same random seed, but any application order can reasonably be considered a adequate model of the system. In our implementation, this order is:</p>
<pre><code>FOR EACH person in the population
	Record the state of the person
	Increase treatment
	Isolate based on treatment level
	IF product is in use
		Isolate based on product
	ENDIF
	Recovery
	Mutation
	Death
ENDFOR
Spread through the population
</code></pre><h4 id="model-type">Model type</h4>
<p>Our model is discrete time, stochastic, and compartmental:</p>
<ul>
<li>
<p>Discrete time means that changes in the model occur at granular timesteps, like turns in a boards game</p>
<p>Below shows the code for how operations are performed on every person in the population each timestep, and data about them recorded</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Make a new data handler for each simulation</span>
self<span style="color:#f92672">.</span>data_handler<span style="color:#f92672">.</span>__init__()

<span style="color:#75715e"># Repeat the simulation for a set number of timesteps</span>
<span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(NUM_TIMESTEPS):

    <span style="color:#75715e"># For each person in the population</span>
    <span style="color:#66d9ef">for</span> person <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>population:

        <span style="color:#75715e"># Record the data throughout the model</span>
        self<span style="color:#f92672">.</span>data_handler<span style="color:#f92672">.</span>record_person(person)

</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Stochastic means that the model is based on random probabilities, as opposed to a deterministic system of equations</p>
<ul>
<li>A set of constant probabilities define the properties of the model</li>
<li>Transitions between states are chosen randomly with these constant probabilities</li>
</ul>
<p>These probabilities, and other variable aspects of the model, such as population size or how many drugs are used, are set as constant values at the top of the model.</p>
<p>Initially, the model only had a parameter for how many different antibiotics are used, and all the associated probabilities (e.g. likelihood of recovery, likelihood of death, etc.) with these antibiotics were the same. However, in the final version, the different antibiotics are named to more closely map to the real world, and they are allowed to have their own separate values for these probabilities. However, for convenience&rsquo;s sake, we introduce meta-parameters which can be used to set all the antibiotics to have the same probability in a given category.
Below shows code for a default setting of these probabilities, the meaning of which will be explained further on:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># General model parameters</span>
NUM_TIMESTEPS <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>
POPULATION_SIZE <span style="color:#f92672">=</span> <span style="color:#ae81ff">500</span>
INITIALLY_INFECTED <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>

<span style="color:#75715e"># Ordered list of drugs used, their properties, and the properties of their</span>
<span style="color:#75715e"># resistant pathogens. Meropenem is a specific drug in the class of Carbapenems</span>
DRUG_NAMES <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;Amoxycillin+&#34;</span>, <span style="color:#e6db74">&#34;Meropenem&#34;</span>, <span style="color:#e6db74">&#34;Colistin&#34;</span>]

PROBABILITY_MOVE_UP_TREATMENT <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.2</span>
TIMESTEPS_MOVE_UP_LAG_TIME <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>
ISOLATION_THRESHOLD <span style="color:#f92672">=</span> DRUG_NAMES<span style="color:#f92672">.</span>index(<span style="color:#e6db74">&#34;Colistin&#34;</span>)

PRODUCT_IN_USE <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
PROBABILIY_PRODUCT_DETECT <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
PRODUCT_DETECTION_LEVEL <span style="color:#f92672">=</span> DRUG_NAMES<span style="color:#f92672">.</span>index(<span style="color:#e6db74">&#34;Meropenem&#34;</span>)

<span style="color:#75715e">############################################################</span>
<span style="color:#75715e"># Use these if you want to set all drugs to the same thing #</span>
<span style="color:#75715e">############################################################</span>

PROBABILITY_GENERAL_RECOVERY <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
PROBABILITY_TREATMENT_RECOVERY <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.3</span>
PROBABILITY_MUTATION <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.25</span>
PROBABILITY_DEATH <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.015</span>
<span style="color:#75715e"># Add time infected into consideration for death chance</span>
DEATH_FUNCTION <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> p, t: round(min(<span style="color:#ae81ff">0.001</span><span style="color:#f92672">*</span>t <span style="color:#f92672">+</span> p, <span style="color:#ae81ff">1</span>), <span style="color:#ae81ff">4</span>)
<span style="color:#75715e"># TODO: Make this more robust</span>
PROBABILITY_SPREAD <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.25</span>
NUM_SPREAD_TO <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>

<span style="color:#75715e">###########################################################################</span>
<span style="color:#75715e"># Set these explicitly for more granular control, or use the above to set #</span>
<span style="color:#75715e"># them all as a group                                                     #</span>
<span style="color:#75715e">###########################################################################</span>

<span style="color:#75715e"># Lookup table of drug properties by their names</span>
DRUG_PROPERTIES <span style="color:#f92672">=</span> {}
DRUG_PROPERTIES[<span style="color:#e6db74">&#34;Amoxycillin+&#34;</span>] <span style="color:#f92672">=</span> (
    PROBABILITY_TREATMENT_RECOVERY,
)
DRUG_PROPERTIES[<span style="color:#e6db74">&#34;Meropenem&#34;</span>] <span style="color:#f92672">=</span> (PROBABILITY_TREATMENT_RECOVERY,)
DRUG_PROPERTIES[<span style="color:#e6db74">&#34;Colistin&#34;</span>] <span style="color:#f92672">=</span> (PROBABILITY_TREATMENT_RECOVERY,)

<span style="color:#75715e"># Lookup table of resistance properties by their names</span>
NUM_RESISTANCES <span style="color:#f92672">=</span> len(DRUG_NAMES)
RESISTANCE_PROPERTIES <span style="color:#f92672">=</span> {}
RESISTANCE_PROPERTIES[<span style="color:#e6db74">&#34;None&#34;</span>] <span style="color:#f92672">=</span> (PROBABILITY_GENERAL_RECOVERY, PROBABILITY_MUTATION, PROBABILITY_SPREAD, NUM_SPREAD_TO, PROBABILITY_DEATH, DEATH_FUNCTION,)
RESISTANCE_PROPERTIES[<span style="color:#e6db74">&#34;Amoxycillin+&#34;</span>] <span style="color:#f92672">=</span> (PROBABILITY_GENERAL_RECOVERY, PROBABILITY_MUTATION, PROBABILITY_SPREAD, NUM_SPREAD_TO, PROBABILITY_DEATH, DEATH_FUNCTION,)
RESISTANCE_PROPERTIES[<span style="color:#e6db74">&#34;Meropenem&#34;</span>] <span style="color:#f92672">=</span> (PROBABILITY_GENERAL_RECOVERY, PROBABILITY_MUTATION, PROBABILITY_SPREAD, NUM_SPREAD_TO, PROBABILITY_DEATH, DEATH_FUNCTION,)
RESISTANCE_PROPERTIES[<span style="color:#e6db74">&#34;Colistin&#34;</span>] <span style="color:#f92672">=</span> (PROBABILITY_GENERAL_RECOVERY, PROBABILITY_MUTATION, PROBABILITY_SPREAD, NUM_SPREAD_TO, PROBABILITY_DEATH, DEATH_FUNCTION,)

</code></pre></td></tr></table>
</div>
</div><p>Additionally, there are internal settings, for example how the model outputs its results.</p>
</li>
<li>
<p>Compartmental means that the model is expressed in terms of the transitions between a set of states. The logic for these transitions forms a fundamental part of the model</p>
</li>
</ul>
<p>The model is at its core a modification of the standard &ldquo;susceptible-infected-recovered&rdquo; (often referred to as SIR) model for epidemic disease. It extends this concept by adding more &ldquo;compartments&rdquo; for additional states people can take when they are infected with increasingly antibiotic resistant pathogens.</p>
<div class="text-center">
    
    
    <img src="../assets/content/model/SIR_graph.png" alt="A diagram of the SIR model. Image source: [1]" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">A diagram of the SIR model. Image source: [1]</p>
    
</div>

<p>There are already examples of models of this class for examining antibiotic resistance in E. coli [2] [3] [4], showing that it is a suitable methodology for this problem. However, we believe that a custom model written from scratch was required to integrate the mechanism of the product being used.</p>
<h4 id="1-pathogen-and-people">1. Pathogen and people</h4>
<p>A pathogen with a probability of death and a probability of recovery spreads through the population.</p>
<ul>
<li>
<p>Patients have a small chance of recovering by themselves, or can be treated with antibiotics, which have a larger chance of curing them</p>
</li>
<li>
<p>Different strains of the pathogen exist, which are resistant to different antibiotics</p>
</li>
<li>
<p>Pathogens can mutate to more resistant strains in specific circumstances explained in the mutation section</p>
</li>
<li>
<p>When they have recovered, they become immune to the all strains of the pathogen</p>
</li>
<li>
<p>Patients also have a small chance of dying due to the pathogen</p>
</li>
</ul>
<p>Hence, patients can be in any of the disjoint states: uninfected, infected (possibly with resistance), immune, or dead.</p>
<p>In the limit of time to infinity, all individuals will be either uninfected, immune or dead, as they will all either not be infected in the first place, or recover or die from the pathogen.</p>
<div class="text-center">
    
    
    <img src="../assets/content/model/general.png" alt="The state transition diagram of every state a person within the population can take" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">The state transition diagram of every state a person within the population can take (for reasons discussed later in the treatment section, pathogenic resistances to antibiotics will occur in a set order)</p>
    
</div>

<div class="text-center">
    
    
    <img src="../assets/content/model/specific_none.png" alt="A state transition diagram of a person" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">A state transition diagram of a person centred around the state of being infected with a pathogen resistant to antibiotic $n$ in the precedence of antibiotics</p>
    
</div>

<h4 id="2-treatment-and-mutation">2. Treatment and mutation</h4>
<p>Antibiotics are used in a specific order, which are numbered accordingly for clarity (with $1$ being the first administered, and $n$ being the last for antibiotics $1..n$). This is to simulate the real-world, where different antibiotics are used in a tiered system, reserving the last for highly dangerous, multi-drug resistant pathogens - and is an important aspect of our model, as our product attempts to identify <em>Carbapenem resistant Enterobacteriaceae</em> (CRE), which are a type of these resistant pathogens.</p>
<p>Pathogens have a small chance of mutating to develop resistance to antibiotics being used to treat them, as such strains will only become dominant when there is a pressure giving them a survival advantage.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Handle Mutation to higher resistance due to treatment</span>
<span style="color:#66d9ef">if</span> decision(person<span style="color:#f92672">.</span>infection<span style="color:#f92672">.</span>mutation_probability):
    person<span style="color:#f92672">.</span>mutate_infection()
</code></pre></td></tr></table>
</div>
</div><div class="text-center">
    
    
    <img src="../assets/content/model/specific_mutation.png" alt="The same specified diagram used above, with additional information about the mutation step to elucidate it" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">The same specified diagram used above, with additional information about the mutation step to elucidate it</p>
    
</div>

<p>The pathogen is modelled as being immediately symptomatic, meaning doctors can immediately identify a patient is infected with it, but they cannot quickly identify whether or not they have a resistant strain if our product is not in use.</p>
<p>Once a person becomes infected, treatment with the lowest tier of antibiotics begins immediately, as they are immediately symptomatic.</p>
<p>If the pathogen is resistant to the antibiotic, the patient still has the opportunity to make a recovery on their own, but the antibiotic will have no effect. If the pathogen is not, the patient has the opportunity to recover both on their own, and via the antibiotic - increasing their likelihood of recovery each timestep.</p>
<p>Since multiple antibiotics are used in a tiered system, there must be a mechanism to move to a higher antibiotic.</p>
<p>There are a number of days which can be set as a parameter for the model, before which the same antibiotic will be used, then after this is exceeded a probability parameter is used each day to decide whether they will be moved up to a higher treatment tier.</p>
<p>Additionally, when our product if a person is detected to be resistant using the product their treatment level is immediately increased to be above that resistance level, as we know that any other lower treatment will be ineffective.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Handle increasing treatment</span>
<span style="color:#66d9ef">if</span> person<span style="color:#f92672">.</span>treatment <span style="color:#f92672">is</span> <span style="color:#66d9ef">None</span>:
    <span style="color:#75715e"># If the person is infected but are not being treated</span>
    <span style="color:#75715e"># with **anything**, start them on the lowest tier</span>
    <span style="color:#75715e"># treatment (we can know that the person is infected,</span>
    <span style="color:#75715e"># but not which tier they are on, without diagnostic</span>
    <span style="color:#75715e"># tools, as we can see they are sick)</span>
    person<span style="color:#f92672">.</span>treatment <span style="color:#f92672">=</span> Treatment()
<span style="color:#66d9ef">else</span>:
    <span style="color:#75715e"># If the person has been treated for a number of</span>
    <span style="color:#75715e"># consecutive days with the, a certain probability is</span>
    <span style="color:#75715e"># exceeded, move them up a treatment tier</span>
    time_cond <span style="color:#f92672">=</span> person<span style="color:#f92672">.</span>treatment<span style="color:#f92672">.</span>time_treated <span style="color:#f92672">&gt;</span> TIMESTEPS_MOVE_UP_LAG_TIME
    rand_cond <span style="color:#f92672">=</span> decision(PROBABILITY_MOVE_UP_TREATMENT)
    <span style="color:#66d9ef">if</span> time_cond <span style="color:#f92672">and</span> rand_cond:
        person<span style="color:#f92672">.</span>increase_treatment()

<span style="color:#75715e"># Handle use of the product</span>
<span style="color:#66d9ef">if</span> person<span style="color:#f92672">.</span>infection<span style="color:#f92672">.</span>get_tier() <span style="color:#f92672">&gt;=</span> PRODUCT_DETECTION_LEVEL:
    <span style="color:#66d9ef">if</span> PRODUCT_IN_USE <span style="color:#f92672">and</span> decision(PROBABILIY_PRODUCT_DETECT):
        <span style="color:#75715e"># If a person has the detected infection, put them on</span>
        <span style="color:#75715e"># a treatment course for it, (i.e. only ever change</span>
        <span style="color:#75715e"># it up to one above)</span>
        <span style="color:#66d9ef">if</span> Params<span style="color:#f92672">.</span>DRUG_NAMES<span style="color:#f92672">.</span>index(person<span style="color:#f92672">.</span>treatment<span style="color:#f92672">.</span>drug) <span style="color:#f92672">&lt;=</span> Params<span style="color:#f92672">.</span>PRODUCT_DETECTION_LEVEL:
            person<span style="color:#f92672">.</span>treatment <span style="color:#f92672">=</span> Treatment(Params<span style="color:#f92672">.</span>DRUG_NAMES[Params<span style="color:#f92672">.</span>PRODUCT_DETECTION_LEVEL<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>])
</code></pre></td></tr></table>
</div>
</div><h4 id="3-spread">3. Spread</h4>
<p>Disease can spread from infected patients to uninfected patients, and patients with a less resistant strain. The likelihood of this occurring, and the number of people spread to each time can be controlled as parameters</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Spread the infection strains throughout the population</span>
<span style="color:#75715e"># We need a deepcopy operation, to prevent someone who has just</span>
<span style="color:#75715e"># been spread to in this timestep spreading the thing they&#39;ve</span>
<span style="color:#75715e"># just received, so technically don&#39;t have yet</span>
updated_population <span style="color:#f92672">=</span> deepcopy(self<span style="color:#f92672">.</span>population)
<span style="color:#66d9ef">for</span> person <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>population:
    <span style="color:#66d9ef">if</span> person<span style="color:#f92672">.</span>infection <span style="color:#f92672">is</span> <span style="color:#f92672">not</span> <span style="color:#66d9ef">None</span> <span style="color:#f92672">and</span> decision(PROBABILITY_SPREAD):
        <span style="color:#66d9ef">for</span> receiver <span style="color:#f92672">in</span> sample(updated_population, NUM_SPREAD_TO):
            person<span style="color:#f92672">.</span>spread_infection(receiver)
self<span style="color:#f92672">.</span>population <span style="color:#f92672">=</span> updated_population[:]
</code></pre></td></tr></table>
</div>
</div><h4 id="4-isolation">4. Isolation</h4>
<p>Patients can be put into isolation, preventing the spreading the disease. This is the main place where the our product differentiates itself.</p>
<p>Without our product, a person is put in isolation when they exceed a threshold of <strong>treatment</strong></p>
<p>With our product, since it provides a fast testing mechanism for highly resistant strains, patients can be detected as having the resistant strain, they are put into isolation when they exceed a threshold of <strong>having the resistant strain</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Isolate if in high enough treatment class (which</span>
<span style="color:#75715e"># is not the same as infection class - this will</span>
<span style="color:#75715e"># likely lag behind)</span>
treatment_tier <span style="color:#f92672">=</span> Infection<span style="color:#f92672">.</span>get_tier_from_resistance(person<span style="color:#f92672">.</span>treatment<span style="color:#f92672">.</span>drug)
<span style="color:#66d9ef">if</span> treatment_tier <span style="color:#f92672">&gt;=</span> ISOLATION_THRESHOLD:
    person<span style="color:#f92672">.</span>isolate()

<span style="color:#75715e"># Handle use of the product</span>
<span style="color:#66d9ef">if</span> person<span style="color:#f92672">.</span>infection<span style="color:#f92672">.</span>get_tier() <span style="color:#f92672">&gt;=</span> PRODUCT_DETECTION_LEVEL:
    <span style="color:#66d9ef">if</span> PRODUCT_IN_USE <span style="color:#f92672">and</span> decision(PROBABILIY_PRODUCT_DETECT):
        <span style="color:#75715e"># Put people into isolation if our product detects</span>
        <span style="color:#75715e"># them as being infected</span>
        person<span style="color:#f92672">.</span>isolate()
</code></pre></td></tr></table>
</div>
</div><div class="text-center">
    
    
    <img src="../assets/content/model/specific_isolation.png" alt="The same specified diagram used above, with additional information about the isolation step to elucidate it" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">The same specified diagram used above, with additional information about the isolation step to elucidate it</p>
    
</div>

<h4 id="5-recovery-and-death">5. Recovery and death</h4>
<p>As discussed in section (1), each timestep, patients can recover (either naturally or via treatment), or patients can die.</p>
<p>Recovery makes the patients immune, meaning they cannot be infected again, essentially removing them from the system. Death also removes patients from the system.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Handle Recovery generally or by treatment if currently infected</span>
general_recovery <span style="color:#f92672">=</span> decision(person<span style="color:#f92672">.</span>infection<span style="color:#f92672">.</span>general_recovery_probability)
treatment_recovery <span style="color:#f92672">=</span> (person<span style="color:#f92672">.</span>correct_treatment() <span style="color:#f92672">and</span>
                    decision(person<span style="color:#f92672">.</span>treatment<span style="color:#f92672">.</span>treatment_recovery_probability))
<span style="color:#66d9ef">if</span> general_recovery <span style="color:#f92672">or</span> treatment_recovery:
    person<span style="color:#f92672">.</span>recover_from_infection()
    <span style="color:#75715e"># Don&#39;t do anything else, as infection/treatment will</span>
    <span style="color:#75715e"># now be set to None</span>
    <span style="color:#66d9ef">continue</span>

<span style="color:#75715e"># Handle deaths due to infection</span>
death_probability <span style="color:#f92672">=</span> person<span style="color:#f92672">.</span>infection<span style="color:#f92672">.</span>death_function(
    person<span style="color:#f92672">.</span>infection<span style="color:#f92672">.</span>death_probability,
    person<span style="color:#f92672">.</span>time_infected
)
<span style="color:#66d9ef">if</span> decision(death_probability):
    person<span style="color:#f92672">.</span>die()
    <span style="color:#75715e"># Don&#39;t do anything else, as infection/treatment will</span>
    <span style="color:#75715e"># now be set to None</span>
    <span style="color:#66d9ef">continue</span>
</code></pre></td></tr></table>
</div>
</div><p>The goal is to create a situation where in the limit of time, the number of uninfected and immune people is maximised, and the number of dead people is minimised.</p>
<h3 id="software-engineering">Software engineering</h3>
<h4 id="model-design-process">Model design process</h4>
<p>We used an iterative design process during the development of the model, as discussed on page 21 in the book &ldquo;Testing and Validation of Computer Simulation Models: Principles, Methods and Applications&rdquo; [5].</p>
<div class="text-center">
    
    
    <img src="../assets/content/model/designBlockDiagram.png" alt="A block diagram of steps in model design" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">A block diagram of steps in model design - taken from &lsquo;Testing and Validation of Computer Simulation Models: Principles, Methods and Applications&rsquo; [5]</p>
    
</div>

<p>We went through three iterative design stages of increasing complexity and proximity to real life before settling on our production code:</p>
<ol>
<li>The first version was a very simple Markov model of people who could be infected forming a population. It did not employ the tiered system of antibiotic treatments, so did not map very closely to the real world. The code is <a href="https://raw.githubusercontent.com/Warwick-iGEM-2021/modelling/main/development_versions/v1.py">available here</a></li>
<li>The second version was an improvement on the first in terms of mapping closer to reality by employing the tiered system of antibiotic treatments. It did this by adding additional <code>Infection</code> and <code>Treatment</code> classes as properties of a <code>Person</code>, and additional logic to move &ldquo;upwards&rdquo; across them in a specific order. The code is <a href="https://raw.githubusercontent.com/Warwick-iGEM-2021/modelling/main/development_versions/v2.py">available here</a></li>
<li>The third version had a number of additional, but smaller, improvements with respect to closely modelling reality. There was an addition of a lag time before people could move up treatment, and the feature that the change of death increases over time being infected. The code is <a href="https://raw.githubusercontent.com/Warwick-iGEM-2021/modelling/main/development_versions/v3.py">available here</a></li>
<li>The final production version included a fairly holistic re-write, in order to add finer granularity of control through parameters, allowing different infections to have different properties, and other additional parameters. On top of this, the version was rigorously tested by hand and via automated tests to identify conceptual errors. The code is available as the main production code on GitHub and PyPI</li>
</ol>
<p>Note that none of these development code files have been rigorously tested in the way the final version has, so are likely to contain conceptual, or even syntax errors. The only purpose of providing access to them is to show the process of development, not to provide them as working models.</p>
<h4 id="automated-testing">Automated testing</h4>
<p>Whilst testing strategies and reasoning for testing are discussed in the &ldquo;Testing and validation&rdquo; section, the implementation of the testing is a point of interest in its own right. We used the <code>unittest</code> module in Python to implement tests for the source code.</p>
<p>An example of a test is as follows, where we check that the boundary case of no-one being infected to start results in no infections for the entire model one. Whilst this might seem trivial, if it fails it is clear something is very wrong with the model, which might be a subtle result of a change made during development, and hence can prevent confusion about model results not making sense by showing that the problem is in the model implementation, not the analysis.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TestModel</span>(unittest<span style="color:#f92672">.</span>TestCase):
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_empty_model</span>(self):
        <span style="color:#e6db74">&#34;&#34;&#34;Test that a model with no infected people always stays fully uninfected&#34;&#34;&#34;</span>
        <span style="color:#75715e"># Change parameters for the test setup and run the test</span>
        Params<span style="color:#f92672">.</span>INITIALLY_INFECTED <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
        m <span style="color:#f92672">=</span> run()
        self<span style="color:#f92672">.</span>assertEqual(m<span style="color:#f92672">.</span>data_handler<span style="color:#f92672">.</span>get_uninfected_data(),
                         [Params<span style="color:#f92672">.</span>POPULATION_SIZE]<span style="color:#f92672">*</span>Params<span style="color:#f92672">.</span>NUM_TIMESTEPS)
        self<span style="color:#f92672">.</span>assertEqual(m<span style="color:#f92672">.</span>data_handler<span style="color:#f92672">.</span>get_infected_data()[<span style="color:#ae81ff">0</span>],
                         [<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span>Params<span style="color:#f92672">.</span>NUM_TIMESTEPS)
        reset_params()
</code></pre></td></tr></table>
</div>
</div><p>An interesting note about these tests is despite the fact they are written as unit tests, which normally refers to tests with a fixed input, these can be thought of as being tested with different inputs dependent on the result of the random number generator.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TestModel</span>(unittest<span style="color:#f92672">.</span>TestCase):
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_empty_model</span>(self):
        <span style="color:#e6db74">&#34;&#34;&#34;Test that a model with no infected people always stays fully uninfected&#34;&#34;&#34;</span>
        <span style="color:#75715e"># Change parameters for the test setup and run the test</span>
        Params<span style="color:#f92672">.</span>INITIALLY_INFECTED <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>

        <span style="color:#75715e"># Repeat the testing phase many times, with random number generation as the</span>
        <span style="color:#75715e"># function input differing each time</span>
        <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">100</span>):
            m <span style="color:#f92672">=</span> run()
            self<span style="color:#f92672">.</span>assertEqual(m<span style="color:#f92672">.</span>data_handler<span style="color:#f92672">.</span>get_uninfected_data(),
                             [Params<span style="color:#f92672">.</span>POPULATION_SIZE]<span style="color:#f92672">*</span>Params<span style="color:#f92672">.</span>NUM_TIMESTEPS)
            self<span style="color:#f92672">.</span>assertEqual(m<span style="color:#f92672">.</span>data_handler<span style="color:#f92672">.</span>get_infected_data()[<span style="color:#ae81ff">0</span>],
                             [<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span>Params<span style="color:#f92672">.</span>NUM_TIMESTEPS)

        reset_params()
</code></pre></td></tr></table>
</div>
</div><p>If the tests are run many times, with many different resulting random number inputs, these unit tests can now be thought of as property based tests. This refers to checking that a function fulfils a property by randomly providing it with values from its input domain, and checking that the resultant outputs fulfil the property. This is a strategy which was pioneered in the functional programming language Haskell [6], and is often considered preferable to unit based tests [7].</p>
<h4 id="version-control-and-cicd">Version control and CI/CD</h4>
<p>Having implemented a robust testing strategy, we now had all the building blocks for a continuous integration/continuous development workflow, as shown below:</p>
<div class="text-center">
    
    
    <img src="../assets/content/model/CI_CD_diagram.png" alt="A continuous integration/continuous development workflow" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">A continuous integration/continuous development workflow</p>
    
</div>

<p>The build phase is relatively simple - writing the code in an editor of your choice, and running it with the Python interpreter, and the testing phase is discussed above.</p>
<p>Throughout the entire project, we used <code>git</code> as version control, due to the vast number of reasons <code>git</code> is helpful in software development. From this, we linked the project to a remote repository on GitHub, which forms the main way to access the most up to data code. This forms the merge and continuous delivery steps.</p>
<p>We chose not to automate publishing the code to PyPI (discussed below), which could be considered the production aspect of the modelling, as the project is still under active development, and minor changes to the repository should not necessarily be pushed, as their general stability and usefulness is not fully known.</p>
<h4 id="transpilation-to-javascript">Transpilation to Javascript</h4>
<p>In order to create the web-based version of the model, we needed to use a language which can be run client side in the browser. Since Python cannot do this, we needed to convert the source code into a language which can - with the obvious choice being Javascript.</p>
<p>Instead of manually re-writing the entire model into Javascript, we decided to use an automated tool to do it for us. This class of tool is called a transpiler, which converts between two languages in the same tier in the language complexity hierarchy (e.g. two high level languages). We considered a number of tools, with the main decision being between <a href="https://brython.info/">Brython</a>, a runtime transpiler which translates the Python code to Javascript on the fly, and <a href="https://www.transcrypt.org/">Transcrypt</a>, a build-time transpiler which translates the code beforehand. We decided to use Transcrypt, as it offers better performance, having pre-compiled the code, and since it allows an easier integration into the Javascript DOM.</p>
<p>The transpilation process was not totally seamless, as some language properties in Python are not supported in Javascript, for example named parameters and adding lists, and not all of the libraries used were supported by Transcrypt, meaning some of the <code>random</code> methods had to be implemented by hand, and the output graphs and excel exporter had to be totally removed.</p>
<p>In order to display the output in a visual manner, we used the <a href="https://www.chartjs.org/">Chart.js</a> package, which is commonly used for client side data plotting.</p>
<h4 id="uploading-to-pypi">Uploading to PyPI</h4>
<p>Since we developed our model in python, and it follows best practices as opposed to just being a standalone script, uploading the repository to PyPI, the Python package index, was fairly trivial.</p>
<p>Doing this greatly simplifies the way in which the package can be distributed. Instead of cloning the repository, and running the code directly through that:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">git clone https://github.com/Warwick-iGEM-2021/modelling
cd modelling/tiered-antibiotic-resistance-model
python3 model.py
</code></pre></td></tr></table>
</div>
</div><p>The module can be installed using <code>pip</code> on the command line, then just imported directly in a Python file:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pip install tiered-antibiotic-resistance-model
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tiered_antibiotic_resistance_model <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
run_and_output()
</code></pre></td></tr></table>
</div>
</div><p>Furthermore the parameters of the model can be set within the other Python file by directly manipulating the <code>Param</code> object, instead of having to go into the source code and change them in the actual model, which is not a best practice.</p>
<p>The <a href="https://pypi.org/project/tiered-antibiotic-resistance-model/2.0.1/">PyPI page for the project is accessible here</a></p>
<h3 id="testing-and-validation">Testing and validation</h3>
<p>It is important to remember that computer models are not infallible. It is impossible for a computer model of a system to &ldquo;perfectly&rdquo; emulate the real system, as that would require total simulation of the entire universe, which is evidently unfeasible. However, closely approximate models provide a wealth of information when correctly implemented, and can provide a level of abstraction to make the applicable in a wide variety of cases.</p>
<p>To ensure that models are sufficiently accurate to the real-world scenario they are trying to emulate - which is required for us to use them to draw conclusions about whether our product will be beneficial, it is important to test and validate them.</p>
<h4 id="levels-of-validation">Levels of validation</h4>
<p>In the paper &ldquo;Validating Computational Models&rdquo; by Kathleen Carley [8], there are four levels of validation described for computational models:</p>
<h5 id="1-grounding">1. Grounding</h5>
<p>The paper defines the grounding technique in the following ways:</p>
<ul>
<li>&ldquo;Grounding involves establishing the reasonableness of a computational model&rdquo; [8]</li>
<li>&ldquo;Grounding involved the use of story-telling, initialization, and evaluation techniques&rdquo; [8]
<ul>
<li>Story-telling: &ldquo;The basic goal of grounding is to establish that the simplifications made in designing the model do not seriously detract from its credibility and the likelihood that it will provide important insights&rdquo; [8]</li>
<li>Initialization: &ldquo;On the initialization front, grounding requires setting the various parameters and procedures so that they match real data&rdquo; [8], for example comparing model outputs, and trends</li>
<li>Performance evaluation: &ldquo;Simple performance evaluation is the process of determining whether the computational model generates the stylized results or behavior expected of the underlying processes&rdquo; [8]</li>
</ul>
</li>
</ul>
<p>For &ldquo;story-telling&rdquo;, the above explanation of the implementation explains the mapping of the model to the real world. The variables within the model are named clearly so the &ldquo;story&rdquo; of the model can be inferred directly from the source code. Both initialization and performance evaluation are encompassed by the following sections on calibrating and verification.</p>
<h5 id="2-calibrating">2. Calibrating</h5>
<p>The paper defines the calibrating technique in the following way:</p>
<p>&ldquo;Calibrating is the process of tuning a model to fit detailed real data. This is a multi-step, often iterative, process in which the model’s processes are altered so that the model’s predictions come to fit, with reasonable tolerance, a set of detailed real data. This approach is generally used for establishing the feasibility of the computational model; i.e., for showing that it is possible for the model to generate results that match the real data. [&hellip;]</p>
<p>Calibrating a model may require the researcher to both set and reset parameters and to alter the fundamental programming, procedures, algorithms, or rules in the computational model. Calibrating establishes, to an extent the validity of the internal workings of the model and its results (at least in a single case).&rdquo; [8]</p>
<p>We inherently used calibration throughout the development phase of the project (see diagram in software engineering above), as the design process involved iteratively designing models, testing them on the scenario data we selected, and adding features and fixes to improve the resemblance of the model to &ldquo;real life&rdquo;.</p>
<h5 id="3-verification">3. Verification</h5>
<p>The paper defines the verification technique in the following way: &ldquo;Verification is a set of techniques for determining the validity of a computational model’s predictions relative to a set of real data. To verify a model, the model’s predictions are compared graphically or statistically with the real data&rdquo; [9]</p>
<p>We graphically compared the data outputs with the expected characteristic &ldquo;S-curve&rdquo; shape which is prevalent in SIR type stochastic models similar to ours. Whilst the individual lines for different resistance levels do not form such a curve, if their total is taken, it does - which is the expected behaviour, as the sum of the resistance levels gives total number infected. This is shown below with the boundary between the pink and the brown items in the graph forming the characteristic curve.</p>
<div class="text-center">
    
    
    <img src="../assets/content/model/stackplot_SIR.png" alt="A stack plot showing the S-curve shape" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">A stack plot showing the characteristic &lsquo;S-curve&rsquo; shape</p>
    
</div>

<p>Additionally, the book notes that &ldquo;A special issue in verification occurs with respect to multi-agent models. Multi-agent models can potentially undergo dual level verification; i.e., verification at both the individual and group level. To wit, does the model accurately predict group level behavior, individual level behavior, or both?&rdquo; [8]</p>
<p>Since our model can be considered to be multi-agent, as it is composed of multiple <code>Person</code> classes forming a population, we needed to take account of this special issue.</p>
<h5 id="4-harmonization">4. Harmonization</h5>
<p>Harmonization is the final, and most complicated, stage of validation proposed in the book. It involves taking multiple sets of data for verification, then forming a linear model from them, and comparing the computational model the the linear one.</p>
<p>We did not attempt harmonization on our model as we thought it was out of scope. We did not have multiple data sets for the niche case we apply our product too, and the process was excessively complex for the time period of the competition.</p>
<h3 id="contextualisation">Contextualisation</h3>
<p>Due to the flexibility of the model, its parameters can be adjusted to simulate the spread of many real-world diseases. Adding such context to the model helps us better understand better how our product could improve the situation in such scenarios.</p>
<h4 id="selected-scenario">Selected scenario</h4>
<h5 id="adapting-parameters">Adapting parameters</h5>
<p>Due to the flexibility of the model, its parameters can be adjusted to simulate the spread of many real-world diseases. Adding such context to the model helps us better understand how our product could improve the situation in such scenarios. We do this by anchoring some of the parameters and expected outputs to available data, giving us more plausible outcomes.</p>
<h5 id="neonatal-bacterial-meningitis">Neonatal bacterial meningitis</h5>
<p>Here we have chosen to use neonatal bacterial meningitis (NBM) as an example. The disease, and the nature of its spread and treatment have numerous properties that can be simulated using the model. NBM can easily be spread within hospitals by medical staff and often has a deadly outcome [10], all of which can be simulated in the model. Furthermore, treatment involves a line of antibiotics, the last of which generally is treatment with meropenem, a carbapenem [11].</p>
<div class="text-center">
    
    
    <img src="../assets/content/model/meropenem.png" alt="A diagram of the structure of meropenem" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">A diagram of the structure of meropenem [12]</p>
    
</div>

<p>However, since the model does not allow for the product to identify resistance to the last line of defence, requiring a later line of defence, we included colistin as the last treatment. Colistin has been used to treat multi-resistant NBM [13], however it is infrequently used due to its harmful side-effects [14].</p>
<p>The parameters of the model have hence been adjusted as such:</p>
<ol>
<li>
<p>NBM has three lines of treatment: amoxicillin + cefotaxime/ceftriaxone, meropenem, and finally colistin. Therefore the model has three levels of treatment and corresponding resistance levels. The first level of treatment will henceforth be referred to as “Amoxicillin+” for the sake of conciseness.</p>
</li>
<li>
<p>There is a 100% mortality rate of untreated NBM [15]. Hence, we have set the chance of recovery if the pathogen is resistant to the current antibiotic in use to zero.</p>
</li>
<li>
<p>There is a 40% overall mortality rate in developed countries [15]. Therefore the parameters have been adjusted such that the expected outcome when our product is not in use averages to a 40% mortality rate.</p>
</li>
</ol>
<h4 id="method">Method</h4>
<p>The parameters used in the model were as follows:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">NUM_TIMESTEPS <span style="color:#f92672">=</span> <span style="color:#ae81ff">150</span>
POPULATION_SIZE <span style="color:#f92672">=</span> <span style="color:#ae81ff">5000</span>
INITIALLY_INFECTED <span style="color:#f92672">=</span> <span style="color:#ae81ff">50</span>

DRUG_NAMES <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;Amoxicillin+&#34;</span>, <span style="color:#e6db74">&#34;Meropenem&#34;</span>, <span style="color:#e6db74">&#34;Colistin&#34;</span>]

PROBABILITY_MOVE_UP_TREATMENT <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.2</span>
TIMESTEPS_MOVE_UP_LAG_TIME <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>
ISOLATION_THRESHOLD <span style="color:#f92672">=</span> DRUG_NAMES<span style="color:#f92672">.</span>index(<span style="color:#e6db74">&#34;Colistin&#34;</span>)

PRODUCT_IN_USE <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
PROBABILIY_PRODUCT_DETECT <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
PRODUCT_DETECTION_LEVEL <span style="color:#f92672">=</span> DRUG_NAMES<span style="color:#f92672">.</span>index(<span style="color:#e6db74">&#34;Meropenem&#34;</span>)

<span style="color:#75715e">############################################################</span>
<span style="color:#75715e"># Use these if you want to set all drugs to the same thing #</span>
<span style="color:#75715e">############################################################</span>

PROBABILITY_GENERAL_RECOVERY <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
PROBABILITY_TREATMENT_RECOVERY <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.3</span>
PROBABILITY_MUTATION <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.25</span>
PROBABILITY_DEATH <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.02</span>
<span style="color:#75715e"># Add time infected into consideration for death chance</span>
DEATH_FUNCTION <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> p, t: round(min(<span style="color:#ae81ff">0.001</span><span style="color:#f92672">*</span>t <span style="color:#f92672">+</span> p, <span style="color:#ae81ff">1</span>), <span style="color:#ae81ff">4</span>)
<span style="color:#75715e"># TODO: Make this more robust</span>
PROBABILITY_SPREAD <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.25</span>
NUM_SPREAD_TO <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</code></pre></td></tr></table>
</div>
</div><p>We ran the programme 10 times with the product in use and 10 times without. Albeit unrealistic in a hospital scenario, the population size was set to 5000 to minimise fluctuations between outcomes due to the stochastic nature of the model.</p>
<p>To further minimise the fluctuations, we then combined all the runs with and without the product respectively to create averaged runs. This meant that, for example, the deaths at timestep 20 of the averaged run without the product was the average of deaths at timestep 20 of each run when the product was not in use.</p>
<p>After each run we also calculated the Death rate (deaths as % of the population), the Mortality rate (deaths as % of the population that was infected), and the Infection rate (the population that was infected as % of the total population). We then calculated the mean value and variance of the Death, Mortality and Infection rates of the runs with and without the product in use respectively. To confirm that there were statistically significant improvements in outcomes when using the product compared to not using the product, we conducted three one-sided hypothesis tests at the 1% level.</p>
<p>Since we used an unrealistically large population size in our initial runs, we also ran the programme again but with the parameters:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">POPULATION_SIZE <span style="color:#f92672">=</span> <span style="color:#ae81ff">200</span>
INITIALLY_INFECTED <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
</code></pre></td></tr></table>
</div>
</div><p>The graphic results of the runs with and without the product in use respectively were then compared to the averaged runs with populations of 5000. This confirmed that the population size does not adversely affect the results of the model, instead merely &ldquo;smoothing the curve&rdquo;, as Markov models with small sample sets tend to give very noisy data, given the law of large numbers.</p>
<p>Finally, we also did some further analysis into how the product affects the outcome of the model by looking a bit closer at the data. This involved looking at the change over time of cases of resistant pathogens and patients put into isolation.</p>
<h4 id="results-and-analysis">Results and analysis</h4>
<h5 id="outputs">Outputs</h5>
<p>A graph showing the change of several variables over time, having averaged 10 runs without the product in use. “Amoxicillin+”, “Meropenem”, and “Colistin” refer to the number of patients carrying a pathogen with resistance to said antibiotic(s). “Infected” is virtually indistinguishable from “Amoxicillin+” as almost all infected patients develop resistance to Amoxicillin+ immediately as treatment starts due to the parameters of the model. Only the first 100 time-steps are shown as the variables change only marginally after that.</p>
<div class="text-center">
    
    
    <img src="../assets/content/model/graph1.png" alt="NBM average simulation without product in use graph" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">A graph of the average simulation results without the product over ten runs</p>
    
</div>

<p>Some statistics from the averaged run over a population of 5000 without the product in use:</p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Mean value</th>
<th>Variance</th>
</tr>
</thead>
<tbody>
<tr>
<td>Number of deaths</td>
<td>1840.6</td>
<td>-</td>
</tr>
<tr>
<td>Number of infected people</td>
<td>4504.9</td>
<td>-</td>
</tr>
<tr>
<td>Infection rate</td>
<td>90.10%</td>
<td>0.0024%</td>
</tr>
<tr>
<td>Mortality rate</td>
<td>40.86%</td>
<td>0.0078%</td>
</tr>
<tr>
<td>Death rate</td>
<td>36.81%</td>
<td>0.0084%</td>
</tr>
</tbody>
</table>
<p>The mortality rate of the averaged run without the product at 40.86% is very close to the actual mortality rate of NBM in developed countries. This means we have anchored the outcome correctly, which should give us more interesting takeaways when we compare with the outcome when the product is in use. The infection rate is very high, which is largely due to the model not simulating space (for example between departments of a hospital). Without a spatial element, there is no barrier to infection apart from people turning immune, dying or being put into isolation.</p>
<div class="text-center">
    
    
    <img src="../assets/content/model/graph2.png" alt="NBM average simulation with the product in use graph" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">A graph of the average simulation results with the product over ten runs</p>
    
</div>

<p>A graph showing the change of several variables over time, having averaged 10 runs with the product in use. “Amoxicillin+”, “Meropenem”, and “Colistin” refer to the number of patients carrying a pathogen with resistance to said antibiotic(s). “Infected” is virtually indistinguishable from “Amoxicillin+” as almost all infected patients develop resistance to Amoxicillin+ immediately as treatment starts due to the parameters of the model. “Meropenem” is virtually indistinguishable from “Isolated” as all patients with resistance to Meropenem are put into isolation when the product is in use, with few patients being put into isolation that are not resistant to Meropenem. Only the first 100 time-steps are shown as the variables change only marginally after that.</p>
<p>Some statistics from the averaged run over a population of 5000 without the product in use:</p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Mean value</th>
<th>Variance</th>
</tr>
</thead>
<tbody>
<tr>
<td>Number of deaths</td>
<td>1635.8</td>
<td>-</td>
</tr>
<tr>
<td>Number of infected people</td>
<td>1635.8</td>
<td>-</td>
</tr>
<tr>
<td>Infection rate</td>
<td>85.85%</td>
<td>0.0296%</td>
</tr>
<tr>
<td>Mortality rate</td>
<td>38.11%</td>
<td>0.0149%</td>
</tr>
<tr>
<td>Death rate</td>
<td>32.72%</td>
<td>0.0309%</td>
</tr>
</tbody>
</table>
<p>There is a clear difference in the number of mean deaths and mean infected compared to when the product was not in use. The total number of infections has dropped by 4.71% and the chance of dying among the infected (the mortality rate) has dropped by 6.56%. This results in a drop of total deaths by 11.13%, a notable improvement thanks to the product.</p>
<p>The drop in infection rates is because of the product proactively putting patients carrying a pathogen resistant to Meropenem in isolation. With more people put into isolation and patients on average being put into isolation earlier, infection rates will inevitably fall (this is covered in more detail in the ‘Further Analysis’ section). Importantly, the product does not only make use of isolation more often, it also ensures the right patients are isolated. The marginal increase in patients in isolation compared to when not using the product will all be from Meropenem-resistant or Colistin-resistant patients. Therefore, lower infection rates not only reflect an overall decrease in the spread of the disease, but they also reflect a decreased likelihood of a patient contracting a multidrug-resistant pathogen. This means the average patient with NBM is more likely to receive effective treatment, further causing mortality rates to drop.</p>
<p>The drop in mortality is therefore due to two reasons. The first is that, as we just outlined, a patient is less likely to carry a multidrug-resistant pathogen and is hence more likely to be treated effectively. The second is that once resistance to Meropenem has been detected, treatment immediately changes to Colistin. This means patients are not unnecessarily treated with Meropenem when it is not effective, decreasing their overall chance of dying.</p>
<p>Since the outcome of the model is largely dependent on probability, we must, however, before moving on verify that the product has led to the improved outcomes, rather than being a result of “fortuitous fluctuations”. In other words, we need to test whether these improvements are actually statistically significant.</p>
<h5 id="hypothesis-tests">Hypothesis tests</h5>
<p>We conducted three difference-in-means hypothesis tests to verify that the product improved the outcomes of the runs. We compared the mean values of infection, mortality and death rates to ensure all improvements were statistically significant.</p>
<p>The null hypothesis is the initial presumption that the two mean values we are comparing are in fact equal and are part of the same distribution. To verify that our product has improved the average outcome, we must try to reject the null hypothesis. We reject the null hypothesis if the probability of a type I error is lower than the significance level chosen.</p>
<p>The probability of a type I error is the likelihood that you reject the null hypothesis when the null hypothesis is in fact correct. We chose a significance level of 1%, which means that if we are able to reject the null hypothesis, it is because there is a less than 1% chance that we are wrong.</p>
<p>We assumed the product cannot worsen the outcome. Hence we conducted one-sided hypothesis tests. This means that our alternative hypothesis (as opposed to the null hypothesis) was that the mean values for infection, mortality and death rates were lower when using the product than when not using it.</p>
<p>We can assume that the outcomes of the model follow a normal distribution. However, we do not know the standard deviation of outcomes. Therefore we were left with two options: to approximate a normal distribution or to use a student’s t-distribution. Since we ran the simulations 10 times using and 10 times not using the product respectively, we have a sample size of 10 to calculate the mean values. This is a very low sample size, which suggested the most appropriate distribution was a student’s t-distribution.</p>
<p>We calculated the probability of a Type I error using this formula:</p>
<p>$$
P \left( t_{n_1 + n_2 - 2} &gt; \frac{\overline{x_1} - \overline{x_2}}{\sqrt{\frac{S_0^2}{n_1} + \frac{S_0^2}{n_2}}} \right)
$$</p>
<p>We let $\overline{x_1}$ be the mean value for any given outcome variable when not using the product and $\overline{x_2}$ the mean value when using the product. $n_1$ and $n_2$ were the sample sizes, which was 10 in both cases. Since the initial assumption is that the null hypothesis holds, $S_0^2$ is the hypothesised variance of the hypothesised real distribution, or in other words the square of the standard deviation of the hypothesised distribution.</p>
<p>Since the sample sizes are equal, we calculate the hypothesised variance using the formula:</p>
<p>$$
S_0^2 = \frac{S_1^2 + S_2^2}{2}
$$</p>
<p>Where $S_1^2$ is the variance of any given outcome variable when not using the product and $S_2^2$ is the equivalent when using the product.</p>
<h6 id="infection-rates">Infection rates</h6>
<p>For the difference-in-means test of the infection rates, we used the following variables and calculation:</p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Mean infection rate without the product</td>
<td>0.9010</td>
</tr>
<tr>
<td>Variance of the infection rate without the product</td>
<td>2.4$\times 10^{-5}$</td>
</tr>
<tr>
<td>Mean infection rate with the product</td>
<td>0.8585</td>
</tr>
<tr>
<td>Variance of the infection rate with the product</td>
<td>2.96$\times 10^{-4}$</td>
</tr>
</tbody>
</table>
<p>$$
P \left( t_{18} &gt; \frac{0.9010 - 0.8585}{\sqrt{\frac{2.4 \times 10^{-5} + 2.96 \times 10^{-4}}{10}}} \right) = P(t_{18} &gt; 7.513) &lt; 1%
$$</p>
<h6 id="mortality-rates">Mortality rates</h6>
<p>For the difference-in-means test of the mortality rates, we used the following variables and calculation:</p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Mean infection rate without the product</td>
<td>0.4086</td>
</tr>
<tr>
<td>Variance of the infection rate without the product</td>
<td>7.8$\times 10^{-5}$</td>
</tr>
<tr>
<td>Mean infection rate with the product</td>
<td>0.3812</td>
</tr>
<tr>
<td>Variance of the infection rate with the product</td>
<td>1.49$\times 10^{-4}$</td>
</tr>
</tbody>
</table>
<p>$$
P \left( t_{18} &gt; \frac{0.4086 - 0.3812}{\sqrt{\frac{7.8 \times 10^{-5} + 1.49 \times 10^{-4}}{10}}} \right) = P(t_{18} &gt; 5.751) &lt; 1%
$$</p>
<h6 id="death-rates">Death rates</h6>
<p>For the difference-in-means test of the death rates, we used the following variables and calculation:</p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Mean infection rate without the product</td>
<td>0.3682</td>
</tr>
<tr>
<td>Variance of the infection rate without the product</td>
<td>8.4$\times 10^{-5}$</td>
</tr>
<tr>
<td>Mean infection rate with the product</td>
<td>0.3273</td>
</tr>
<tr>
<td>Variance of the infection rate with the product</td>
<td>3.09$\times 10^{-4}$</td>
</tr>
</tbody>
</table>
<p>$$
P \left( t_{18} &gt; \frac{0.3682 - 0.3273}{\sqrt{\frac{8.4 \times 10^{-5} + 3.09 \times 10^{-4}}{10}}} \right) = P(t_{18} &gt; 6.524) &lt; 1%
$$</p>
<p>Thus, we see that all changes in means are statistically significant, implying that the product has significantly improved the expected outcome of the model.</p>
<h5 id="further-analysis">Further analysis</h5>
<p>Digging deeper into how the product impacts the outcome of the model, we can look at how variables interact over time. While the programme does not give us granular data to the extent that we can conditionalise the patients on certain variables, we can see how trends relate to each other.</p>
<div class="text-center">
    
    
    <img src="../assets/content/model/graph3.png" alt="NBM average simulation without product in use, focussing on resistances and isolation graph" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">A graph of the average simulation results without the product over ten runs, focussing on resistances and isolation graph</p>
    
</div>

<p>A graph showing the change of frequency in Meropenem and Colistin resistances as well as isolation over time, having averaged 10 runs without the product in use. As resistance to Colistin naturally yields resistance again Meropenem in the model, the frequency of resistance to Meropenem is always higher than that to Colistin. It is clear that isolation is lagging behind the spread of resistant pathogens, with many people who carry and could spread pathogens resistant to Meropenems not being put into isolation. At peak levels, resistance to Meropenem and Colistin reaches 496.8 and 256.5 respectively, while peak isolation reaches 295.5.</p>
<p>A graph showing the change of frequency in Meropenem and Colistin resistances as well as isolation over time, having averaged 10 runs with the product in use. As resistance to Colistin naturally yields resistance again Meropenem in the model, the frequency of resistance to Meropenem is always higher than that to Colistin, however only by a slight amount. The frequency of resistance to Meropenem and that of being put into isolation is almost indistinguishable, as everyone who is resistant to Meropenem is put into isolation. The frequency of resistance to Meropenem is slightly higher than isolation levels while the disease is still spreading since patients only enter isolation the timestep after they develop Meropenem-resistance. At peak levels, resistance to Meropenem and Colistin reaches 323.6 and 271.7 respectively, while peak isolation reaches 313.5.</p>
<p>The first notable takeaway when comparing the data is the difference in frequency of resistance to Meropenem. At peak levels, not using the product increases the frequency of resistance to Meropenem by 53%. This is because patients who carry resistant pathogens are quickly put into isolation when using the product, preventing further spread. Notably, peak isolation is only 6% higher, which suggests that it is not merely putting more people into isolation that prevents spread.</p>
<div class="text-center">
    
    
    <img src="../assets/content/model/graph4.png" alt="NBM average simulation with the product in use, focussing on resistances and isolation graph" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">A graph of the average simulation results with the product over ten runs, focussing on resistances and isolation graph</p>
    
</div>

<p>Looking at timestep 30, isolation in the averaged run with the product is at 75.1, while isolation in the averaged run without the product is at 49.9, a massive 50.5% increase.</p>
<p>At timestep 60, isolation in the averaged run with the product is at 274.7, while isolation in the averaged run without the product is at 267.4, a mere 2.7% increase.</p>
<p>This rather qualitative look at the data suggests that the reason why the product prevents spread is not because it puts more people into isolation, but because it puts them into isolation <em>earlier</em>. This is important because it implies hospitals in the real world would not have to acquire higher capacity to accommodate patients with resistant pathogens, but can improve outcomes by using existing capacity more proactively.</p>
<p>Furthermore, the insights into isolation also explain why the product causes overall infection rates to decrease. While putting more people into isolation will inevitably decrease infection rates, putting them earlier into isolation will have the same effect.</p>
<p>Something else to note is the higher frequency of resistance to Colistin when using the product. Peak resistance when using the product reaches 271.7 compared to 256.5 when not using the product, a 5.9% increase. While this may not seem high, it has important implications as resistance again Colistin prevents the effective use of <em>any antibiotic</em>. Once a patient contracts a Colistin-resistant pathogen in this scenario, with no chance of a natural recovery, the patient is guaranteed to die.</p>
<p>Why does this happen? When the product detects resistance to Meropenem, treatment immediately changes to Colistin. This means that overall when using the product, more people are treated with Colistin than otherwise. Hence, while the frequency of Meropenem-resistance might be lower, the likelihood a pathogen develops resistance against Colistin if it is already resistant against Meropenem is much higher since resistance can only develop if it is treated with Colistin.</p>
<p>Is this a problem? Not necessarily, for two reasons. First of all, Colistin is only used when all other options are exhausted. In the case of a patient resistant to Meropenem, Colistin is the only effective treatment available to them. Since the chance of recovering without effective treatment is zero, not treating them is effectively letting them die. Furthermore, despite Colistin-resistance increasing in frequency, it is much less likely to spread. Without the product, we cannot know who carries Colistin-resistant pathogens, hence they are not guaranteed to be in isolation. Using the product, however, we always detect any patient resistant to Meropenem <em>or any higher-tier antibiotic</em>. This means all patients with resistance to Colistin are also put in isolation. Hence Colistin-resistance will not spread when the product is used. This is not totally true to the real world, and the change to fix this is discussed in the future work section, as we did not have time to propagate all the new data a fix to this would generate. However, we performed an informal test on the proposed fix (shown below), and found that the change appeared to be negligible.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">if</span> person<span style="color:#f92672">.</span>infection<span style="color:#f92672">.</span>get_tier() <span style="color:#f92672">&gt;=</span> PRODUCT_DETECTION_LEVEL:
</code></pre></td></tr></table>
</div>
</div><p>Is replaced by</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">if</span> person<span style="color:#f92672">.</span>infection<span style="color:#f92672">.</span>get_tier() <span style="color:#f92672">==</span> PRODUCT_DETECTION_LEVEL:
</code></pre></td></tr></table>
</div>
</div><h5 id="using-a-small-population">Using a small population</h5>
<p>Below, we show pairs of graphs of results with large and small population sizes for comparison</p>
<p><img src="./diagrams/graph5.png" alt="NBM average simulation (population=5000) without product, focussing on Meropenem resistance graph"></p>
<div class="text-center">
    
    
    <img src="../assets/content/model/graph5.png" alt="NBM average simulation (population=5000) without product, focussing on Meropenem resistance graph" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">A graph of the average simulation results for a population of five thousand people, without the product over ten runs, focussing on Meropenem resistance graph</p>
    
</div>

<p>A graph showing the change of several variables over time, having averaged 10 runs without the product in use. “Meropenem” refers to the number of patients carrying a pathogen with resistance to Meropenem. Only the first 100 time-steps are shown as the variables change only marginally after that.</p>
<div class="text-center">
    
    
    <img src="../assets/content/model/graph6.png" alt="NBM average simulation (population=200) without product, focussing on Meropenem resistance graph" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">A graph of the average simulation results for a population of two hundred people, without the product over ten runs, focussing on Meropenem resistance graph</p>
    
</div>

<p>A graph showing the change of several variables over time, when the population size was set to 200 and initially infected at 10, without the product in use. “Meropenem” refers to the number of patients carrying a pathogen with resistance to Meropenem. Only the first 100 time-steps are shown as the variables change only marginally after that.</p>
<div class="text-center">
    
    
    <img src="../assets/content/model/graph7.png" alt="NBM average simulation (population=5000) with product, focussing on Meropenem resistance graph" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">A graph of the average simulation results for a population of size five thousand people, with the product over ten runs, focussing on Meropenem resistance graph</p>
    
</div>

<p>A graph showing the change of several variables over time, having averaged 10 runs with the product in use. “Meropenem” refers to the number of patients carrying a pathogen with resistance to Meropenem. Only the first 100 time-steps are shown as the variables change only marginally after that.</p>
<div class="text-center">
    
    
    <img src="../assets/content/model/graph8.png" alt="NBM average simulation (population=200) with product, focussing on Meropenem resistance graph" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">A graph of the average simulation results for a population of two hundred people, with the product over ten runs, focussing on Meropenem resistance graph</p>
    
</div>

<p>A graph showing the change of several variables over time, when the population size was set to 200 and initially infected at 10, with the product in use. “Meropenem” refers to the number of patients carrying a pathogen with resistance to Meropenem. Only the first 100 time-steps are shown as the variables change only marginally after that.</p>
<p>As you can see, the runs with lower populations sizes and fewer infected at the start provide similar results to the averaged runs with much higher populations. They largely have the same outcomes, with the simulation not using the product ending up with 88%, 37% and 32% infection, mortality and death rates respectively, and the simulation using the product ending up with 90%, 35% and 32% infection, mortality and death rates respectively.</p>
<p>There are a few things worth noting. At surface level it seems as if the product made no difference in the runs with smaller population sizes, as the death rate was the same when using compared to when not using the product. Furthermore, in the run with the small population and with the product in use, the peak in cases was much earlier. The takeaway is that due to the model being stochastic, small sample sizes result in very different outcomes. This does not mean the product is less useful, it only points to the necessity of modelling with large enough sample sizes to get an accurate measurement of its impact.</p>
<p>All in all, the major trends seen in the simulations are very similar when comparing the averaged runs and the runs with the smaller populations. This indicates that the averaged runs give us a useful indicator of how the model works even with smaller populations.</p>
<h4 id="implications">Implications</h4>
<p>Through our analysis we have been able to find several useful takeaways. First of all, in the case of neonatal bacterial meningitis, the product can decrease the total amount of deaths in a population through two means.</p>
<ol>
<li>
<p>Ensuring patients carrying a pathogen resistant to Meropenem are treated with an effective treatment, such as Colistin, thereby lowering mortality rates.</p>
</li>
<li>
<p>Ensuring patients carrying a pathogen resistant to Meropenem are proactively put into isolation, directly lowering infection rates and indirectly lowering mortality rates, by preventing spread of Meropenem-resistance. Notably, the product does not seem to increase overall isolation rates by much. Rather, it puts patients into isolation earlier. Therefore hospitals are not required to increase isolation capacity, the product just allows any existing capacity to be used more effectively.</p>
</li>
</ol>
<p>These two mechanisms work to decrease the infection rate by 4.71% and the mortality rate by 6.56%, overall resulting in a 11.13% lower death rate. Hypothesis testing confirmed all these improvements are statistically significant.</p>
<p>One cause for concern is the increased frequency of resistance to Colistin. At peak levels, using the product increased Colistin resistance by 5.9%. This is due to the product putting more people on Colistin treatment. While at surface level this might seem like an issue, one has to keep in mind two things.</p>
<ol>
<li>
<p>The reason for higher use of Colistin is because all other options are exhausted. In the case of NBM, not treating a patient resistant to Meropenem with Colistin is effectively letting them die.</p>
</li>
<li>
<p>Thanks to the product putting patients resistant to Meropenem or any higher tier antibiotic in isolation, all patients with resistance to Colistin are also put in isolation. Hence Colistin-resistance will not spread.</p>
</li>
</ol>
<p>While these statistics paint a promising picture, one needs to keep in mind that these are based on averaged runs with a large sample size. Were you to run the programme again trying to simulate the spread of NBM in an actual hospital department, the population will have to be decreased. Instead of using 5000 patients, a more realistic scenario would be hundreds or even tens of patients. Since the model is stochastic, the probabilities of individual events will lead to very different outcomes every time the programme is ran. Therefore, it is unrealistic to always expect the product to have the same impact. However, the test runs with populations of 200 tell us something interesting. While the outcomes will vary a lot, the averaged runs are good at predicting overall trends in terms of resistance frequencies and infection, mortality and death rates. Furthermore, they allow us to estimate the average impact of the product. Therefore, the unrealistic large population size of the averaged runs is not a reason to dispute any insights we get from them.</p>
<p>More generally, the contextualisation shows that the model can be useful to simulate real-world scenarios, and both qualify and quantify the impact of using the product. Generally, the more parameters that can be anchored, the more realistic the simulation and the more takeaways can be made. The simulation of our product being used to combat neonatal bacterial meningitis could just as well be applied to scenarios with other diseases, helping us understand how our product could make a difference there as well.</p>
<h3 id="development-and-future-work">Development and future work</h3>
<p>Throughout the development process, we presented the modelling work to other members of our team and our principal investigators, along with an external expert in the field, <a href="https://warwick.ac.uk/fac/sci/eng/people/alexander_darlington/">Alex Darlington</a>. Presenting our work was helpful not only for ensuring that we could explain everything fully and understandably, but also as we received useful suggestions about ways we could improve the model.</p>
<p>A table of suggested improvements we received during development is:</p>
<table>
<thead>
<tr>
<th>Proposer</th>
<th>Summary</th>
<th>Done?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Alex Darlington</td>
<td>Real hospitals only contain a fairly small number of people susceptible within the model, maximum 250, so the population size should be limited by that. This has the effect of increasing variance in the Markov model, as the law of large numbers does not apply, however, it is important for realistic simulation</td>
<td>Yes</td>
</tr>
<tr>
<td>Alex Darlington</td>
<td>Add the use of a &ldquo;last resort&rdquo; drug, such as Colistin, to resolve the issue of the product detection being too late to make any meaningful action. For example, if a Carbapen is the final drug in the hierarchy, detection of resistance is not useful, as the highest possible isolation threshold is being treated with it, which is a pre-requisite for developing resistance, so people will never be isolated as a result, and there is no higher tier treatment to use, so better treatment cannot be given either.</td>
<td>Yes</td>
</tr>
<tr>
<td>Alex Darlington</td>
<td>Add an increasing risk of death if a person has been infected for a long time, as in the real world, people become frail after having been sick for some time.</td>
<td>Yes</td>
</tr>
<tr>
<td>Axel Schoerner Emillon</td>
<td>Change the detection method to only detect whether someone is currently resistant to Carbapenems, rather than if they have any higher tier resistance, as it is not a pre-requisite in the real world given that mutations might not occur in the Carbapenem treatment stage. This was not implemented as it was identified very late in the process after most of the analysis was completed and we would not have had time to redo it, but we performed an informal test, and found it caused a negligible difference in the model results.</td>
<td>No</td>
</tr>
</tbody>
</table>
<p>A table of suggested future work we received during development is:</p>
<table>
<thead>
<tr>
<th>Proposer</th>
<th>Summary</th>
<th>Accepted?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Alex Darlington</td>
<td>Add a cap of the people who can be isolated at one time, as there is a physical limitation of beds in hospital. This was rejected as a change as isolation can be modelled as just more regular changing of PPE, rather than necessarily having totally discrete rooms.</td>
<td>No</td>
</tr>
<tr>
<td>Alex Darlington</td>
<td>Add a spatial aspect to the model, for example having two wards which cannot spread to each other, but having staff who serve both wards and can become infected, in order to act as transmission vectors between the two wards.</td>
<td>Yes</td>
</tr>
<tr>
<td>Axel Schoerner Emillon</td>
<td>Add an asymptomatic phase to the infections, where people can have the infection and be able to transmit it, but they are have no symptoms, so treatment will no start.</td>
<td>Yes</td>
</tr>
</tbody>
</table>
<h3 id="conclusion">Conclusion</h3>
<p>Given the fact that we have tested and validated our model to be sufficiently representative of the real world, and the model output indicates that the use of the product reduces the presence of antibiotic resistant pathogenic strains in our selected scenario, we conclude that our product is beneficial.</p>
<p>There are a number of aspects in which we could expand our model into if we did not have the time constraints of the iGEM competition, but we believe that the model in its current state both achieves its goal of showing our product is beneficial, along with being a useful tool for understanding the issue of antibiotic resistance in its own right.</p>
<h3 id="discussion">Discussion</h3>
<p>Some common questions about the model are answered below:</p>
<ul>
<li>
<p>Q. Is the model realistic</p>
<p>A. No, very little about it is realistic. It is an abstraction of the real world which discards many unnecessary complexities, in order to simply and efficiently simulate how resistance spreads and is combatted. It is not viable to make a wholly realistic model, as this inevitable turns into a &ldquo;hospital simulator&rdquo;, and would be too complex to design, and take too long to run on current computers.</p>
</li>
<li>
<p>Q. Is the model useful</p>
<p>A. Yes, because it provides several helpful insights:</p>
<ul>
<li>The impact our product will have on the spread of resistance just by quickly detecting who to put into isolation</li>
<li>Whether higher or lower mortality or transmissibility of a disease increase or decrease the effectiveness</li>
</ul>
</li>
<li>
<p>Q. What potential improvements are there</p>
<p>A. It would be possible to add additional features to the model to make it more realistic, for example:</p>
<ul>
<li>Spatial considerations – e.g. modelling multiple wards with movement between them</li>
<li>Asymptomatic transmission periods of infection</li>
</ul>
<p>however, these are beyond the scope of our project</p>
</li>
<li>
<p>How does the model compare to other existent ones</p>
</li>
<li>
<p>Q. Can the model be applied to current issues, i.e. the COVID pandemic</p>
<p>A. Since the model is a very generic abstraction of the real world, by adjusting it&rsquo;s parameters a vast amount of different scenarios can be modelled. The key issue in adapting it to different scenarios is if they fit the inherent logic and states hard-coded into it. Since COVID is a viral infection, as opposed to a bacterial infection, antibiotics cannot be used to treat it, so the tiered system of antibiotic uses fits less cleanly to it, however, they could instead be considered as increasingly aggressive treatment options, to which it also grows resistant. However, the logic around our product would not apply, as viral infections are not affected by carbapenem, which is the antibiotic we focus on.</p>
</li>
</ul>


</div>

<div class="content-page">

<h2 id="modelling-with-nupack">Modelling with NUPACK</h2>
<p>We used NUPACK, a software suite used to model possible nucleic acid structures,
to design our gRNAs. We used SnapGene to identify a highly conserved section of
our target gene (OXA-48), which we could use to design a corresponding gRNA. The
OXA-48 sequence we selected was as follows:</p>
<div class="text-center">
    
    
    <img src="../assets/content/model/NUPACKsequence1.png" alt="The selected gene sequence" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">The selected gene sequence</p>
    
</div>

<p>The sequence for the gRNA we designed was as follows:</p>
<div class="text-center">
    
    
    <img src="../assets/content/model/NUPACKsequence2.png" alt="The gene sequence we designed" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">The gene sequence we designed</p>
    
</div>

<p>In the above diagrams:</p>
<ul>
<li>Green = spacer (DNA binding site for the Cas9)</li>
<li>Yellow = sensing loop (important for RNA recognition)</li>
<li>Red = clamp (antisense Cas9 inhibitor)</li>
<li>Blue = extended sensing domain</li>
</ul>
<p>The yellow section on the OXA-48 RNA corresponds to the yellow section on our
gRNA, which would be our sensing loop. The blue section on the OXA-48 RNA
corresponds to the extended sensing domain on our gRNA.</p>
<p>When we inserted our gRNA sequence into NUPACK, we obtained two different closed
conformations:</p>
<div class="text-center">
    
    
    <img src="../assets/content/model/gRNA1.svg" alt="The first closed formation generated by NUPACK" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">The first closed formation generated by NUPACK</p>
    
</div>

<div class="text-center">
    
    
    <img src="../assets/content/model/gRNA2.svg" alt="The second closed formation generated by NUPACK" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">The second closed formation generated by NUPACK</p>
    
</div>

<p>The first conformation is what a single molecule of our gRNA would look like,
and the second conformation is what happens when two gRNA molecules bind to one
another. The colours shown represent the probability that those specific bonds
will form. The dark red nucleotides indicate a very stable structure. The light
blue areas are where the trigger RNA will eventually come and bind, so these
bonds are less stable and much more likely to break as a consequence. Double
stranded nucleotides prevent gRNA function, so this closed conformation is
inactive.</p>
<p>When we inserted the OXA-48 (trigger RNA) sequence into NUPACK, we received this
conformation for the gRNA:</p>
<div class="text-center">
    
    
    <img src="../assets/content/model/gRNA3.svg" alt="A conformation for the gRNA generated by NUPACK" class="centered-image" decoding="async"/>
    
    
        <p class="hugo-figure-caption">A conformation for the gRNA generated by NUPACK</p>
    
</div>

<p>When the gRNA comes into close proximity with the trigger RNA, it changes into
an open, active conformation. The previously weak, light blue bonds break, and
the target RNA can bind to the single nucleotides to form a double-stranded
molecule once more. This double-stranded molecule has a much stabler structure
with far higher binding probabilities than before.</p>
<p>In the open, active conformation, the gRNA is now able to bind to the dCas9.
This brings the dCas9 into close proximity with the trigger RNA so they can
bind. Thus the dCas9 is able to recognise the target RNA and cause the
transcription of GFP to give us a visual indicator that the OXA-48 gene is
present.</p>


</div>

<div class="content-page">

<h3 id="references">References</h3>
<p>[1] Simon, C., 2020. <em>The SIR dynamic model of infectious disease transmission and its analogy with chemical kinetics</em>. PeerJ Physical Chemistry, 2, p.e14.</p>
<p>[2] Niewiadomska, A. Jayabalasingham, B. Seidman, J. Willem, L. Grenfell, B. Spiro, D. Viboud, C. 2019. <em>Population-level mathematical modeling of antimicrobial resistance: a systematic review</em>. BMC Medicine. Available at: <a href="https://bmcmedicine.biomedcentral.com/articles/10.1186/s12916-019-1314-9">https://bmcmedicine.biomedcentral.com/articles/10.1186/s12916-019-1314-9</a> [Accessed 16 October 2021]</p>
<p>[3] Lakin, S. Kuhnle, A. Alipanahi, B. Noyes, N. Dean, C. Muggli, M. Raymond, R. Abdo, Z. Prosperi, M. Belk, K. Morley, P. Boucher, C. 2019. <em>Hierarchical Hidden Markov models enable accurate and diverse detection of antimicrobial resistance sequences</em>. Nature. Available at: <a href="https://www.nature.com/articles/s42003-019-0545-9">https://www.nature.com/articles/s42003-019-0545-9</a> [Accessed 16 October 2021]</p>
<p>[4] Love, W. Zawack, K. Booth, J. Grӧhn, Y. Lanzas, C. 2016. <em>Markov Networks of Collateral Resistance: National Antimicrobial Resistance Monitoring System Surveillance Results from Escherichia coli Isolates, 2004-2012</em>. PLOS Computational Biology. Available at: <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005160">https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005160</a> [Accessed 16 October 2021]</p>
<p>[5] Murray-Smith, D. 2015. <em>Testing and Validation of Computer Simulation Models: Principles, Methods and Applications</em> (1st. ed.). Springer Publishing Company, Incorporated.</p>
<p>[6] Dubien, N. 2018, <em>Introduction to Property Based Testing - Another test philosophy introduced by QuickCheck</em>. Available at: <a href="https://medium.com/criteo-engineering/introduction-to-property-based-testing-f5236229d237">https://medium.com/criteo-engineering/introduction-to-property-based-testing-f5236229d237</a> [Accessed 16 October 2021]</p>
<p>[7] Nygard, M. 2013. <em>Better Than Unit Tests</em>. Cognitect blog. Available at: <a href="https://www.cognitect.com/blog/2013/11/26/better-than-unit-tests">https://www.cognitect.com/blog/2013/11/26/better-than-unit-tests</a> [Accessed 16 October 2021]</p>
<p>[8] Kathleen, C. 1996. <em>Validating Computational Models</em>. [pdf] Available at: casos.cs.cmu.edu/publications/papers/howtoanalyze.pdf [Accessed 16 October 2021]</p>
<p>[9] Kleijnen, J. 1995. <em>Statistical Validation of Simulation Models</em>. European Journal of Operational Research, 82(1): 145-162</p>
<p>[10] Şah İpek, M., 2019. <em>Neonatal Bacterial Meningitis</em>. Neonatal Medicine.</p>
<p>[11] 2017. <em>Management of Bacterial Meningitis in infants &lt;3 months</em>. [pdf] Meningitis Research Foundation. Available at: <a href="https://www.meningitis.org/getmedia/75ce0638-a815-4154-b504-b18c462320c8/Neo-Natal-Algorithm-Nov-2017">https://www.meningitis.org/getmedia/75ce0638-a815-4154-b504-b18c462320c8/Neo-Natal-Algorithm-Nov-2017</a> [Accessed 15 October 2021].</p>
<p>[12] Mills, B. 2009. <em>Ball-and-stick model of the meropenem molecule</em>. Wikimedia Commons. Available at: <a href="https://commons.wikimedia.org/wiki/File:Meropenem-from-xtal-1992-3D-balls.png">https://commons.wikimedia.org/wiki/File:Meropenem-from-xtal-1992-3D-balls.png</a> [Accessed 19 October 2021]</p>
<p>[13] Mahabeer, P., Mzimela, B., Lawler, M., Singh-Moodley, A., Singh, R. and Mlisana, K., 2018. <em>Colistin-resistant Acinetobacter baumanniias a cause of neonatal ventriculitis</em>. Southern African Journal of Infectious Diseases, pp.1-3.</p>
<p>[14] Nation, R. and Li, J., 2009. <em>Colistin in the 21st century</em>. Current Opinion in Infectious Diseases, 22(6), pp.535-543.</p>
<p>[15] Tesini, B., 2020. <em>Neonatal Bacterial Meningitis</em>. [online] MSD Manual Professional Edition. Available at: <a href="https://www.msdmanuals.com/en-gb/professional/pediatrics/infections-in-neonates/neonatal-bacterial-meningitis">https://www.msdmanuals.com/en-gb/professional/pediatrics/infections-in-neonates/neonatal-bacterial-meningitis</a> [Accessed 15 October 2021].</p>

                </div>
            </section>
        </div>
    

</section>

        </div>

        <footer id="footer" role="contentinfo">
    <div class="container">

        
        <div id="sponsor-logos">
            <img src="../assets/images/sponsors.png" alt="Sponsors">
        </div>

        
        <div id="contact-info" class="text-center">
            <a href="https://twitter.com/warwickigem" class="icon-button twitter">
                <i class="fab fa-twitter"></i><span></span>
            </a>
            <a href="https://www.instagram.com/igem_warwick" class="icon-button instagram">
                <i class="fab fa-instagram"></i><span></span>
            </a>
            <a href="https://www.facebook.com/WarwickIGEM" class="icon-button facebook">
                <i class="fab fa-facebook"></i><span></span>
            </a>
            <a href="mailto:igem@warwick.ac.uk" class="icon-button email">
                <i class="fa fa-envelope"></i><span></span>
            </a>
            <a href="https://warwick.ac.uk/" class="icon-button home">
                <i class="fa fa-home"></i><span></span>
            </a>
        </div>


        
        <div id="licensing">
            <div class="row">
                <div class="col-sm">
                    &copy; 2021 - Warwick iGEM CREscent, all rights reserved
                </div>
                <div class="col-sm">
                    Website content under <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" class="license-image" src="../assets/images/CC_BY_License.png"/></a>
                </div>
                <div class="col-sm">
                    Website generator theme under <a rel="license" href="https://opensource.org/licenses/MIT"><img alt="MIT License" class="license-image" src="../assets/images/MIT_logo.svg" /></a>
                </div>
            </div>
        </div>
    </div>
</footer>


    </body>

    
<div id="globalWrapper" style="display: none;">
<div id="content">
<div id="HQ_page">
<div id="bodyContent">
<div id="mw-content-text">
<p>


</html>
